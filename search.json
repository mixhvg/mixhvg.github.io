[{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ruzhang Zhao. Author, maintainer. Hongkai Ji. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Zhao R, Ji H (2025). mixhvg: Mixture Multiple Highly Variable Feature Selection Methods. R package version 1.0.1.","code":"@Manual{,   title = {mixhvg: Mixture of Multiple Highly Variable Feature Selection Methods},   author = {Ruzhang Zhao and Hongkai Ji},   year = {2025},   note = {R package version 1.0.1}, }"},{"path":[]},{"path":"/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"package mixhvg works highly variable gene selection, including popular public available methods, also mixture multiple highly variable gene selection methods. mixture methods can combine advantages captured single method. function FindVariableFeaturesMix inherits FindVariableFeatures function Seurat Package, can used FindVariableFeatures. Also, accepts dense sparse matrix input. Find tutorial website https://mixhvg.github.io. default, mixhvg accepts raw count matrix input performs necessary preprocessing internally, including log-normalization PFlogPF transformation. However, users may also input Seurat object. Seurat object contains raw count matrix, mixhvg handle way standalone count matrix. Seurat object includes raw counts user-processed log-normalized counts, log-normalized data Seurat object used directly methods require (e.g., lognc methods), raw counts still used methods (e.g., ct, nc, PFlogPF methods).","code":""},{"path":"/index.html","id":"news","dir":"","previous_headings":"","what":"News","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"Sept. 15th, 2024: package mixhvg updated version 1.0.1, can support use Seurat version 5. Sept. 1st, 2024: package mixhvg updated version 0.2.1. Aug. 26th, 2024: paper biorXiv preprint version: Zhao, R., Lu, J., Zhou, W., Zhao, N., & Ji, H. (2024). systematic evaluation highly variable gene selection methods single-cell RNA-sequencing. bioRxiv, 2024-08.","code":""},{"path":"/index.html","id":"download","dir":"","previous_headings":"","what":"Download","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"Please download mixhvg package CRAN. Please use GitHub repo download updated package.","code":"install.packages(\"mixhvg\") devtools::install_github(\"RuzhangZhao/mixhvg\")"},{"path":"/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"two inputs can used FindVariableFeaturesMix function. example data comes 10x Genomics. may use link download processed data. processed data named pbmc3k_rna.rds. Matrix input: takes count matrix. log normalized result object: takes count normalized matrices Seurat Object. log normalized result object: takes count matrix Seurat Object.","code":""},{"path":"/index.html","id":"seurat-object-as-input","dir":"","previous_headings":"Usage","what":"Seurat Object as Input","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"One may use FindVariableFeaturesMix replace FindVariableFeatures function analysis pipeline Seurat. example,","code":"pbmc<-readRDS(\"pbmc3k_rna.rds\") library(Seurat) library(mixhvg) object<-CreateSeuratObject(pbmc) object<-FindVariableFeaturesMix(object,nfeatures=2000) head(VariableFeatures(object)) # [1] \"CD74\"  \"LYZ\"   \"IGLC3\" \"IGKC\"  \"RPS29\" \"IGHA1\" object<-CreateSeuratObject(pbmc) object<-FindVariableFeaturesMix(object) object<-NormalizeData(object,verbose=FALSE) object<-ScaleData(object,verbose = FALSE) object<-RunPCA(object,npcs=30,verbose=FALSE) object<-RunUMAP(object,dims=1:30,verbose = FALSE)"},{"path":"/index.html","id":"matrix-as-input","dir":"","previous_headings":"Usage","what":"Matrix as Input","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"","code":"pbmc<-readRDS(\"pbmc3k_rna.rds\") library(mixhvg) pbmc_hvg<-FindVariableFeaturesMix(pbmc,nfeatures=2000) head(pbmc_hvg) # [1] \"CD74\"  \"LYZ\"   \"IGLC3\" \"IGKC\"  \"RPS29\" \"IGHA1\""},{"path":"/index.html","id":"different-methods","dir":"","previous_headings":"Usage","what":"Different Methods","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"method.names can take one method multiple methods mixture. following example, use small cell sorting single-cell RNA-seq dataset true label, downloaded large PBMC dataset. Download example dataset using link. data provided work (Wang, J., Agarwal, D., Huang, M., Hu, G., Zhou, Z., Ye, C., & Zhang, N. R. (2019). Data denoising transfer learning single-cell transcriptomics. Nature methods, 16(9), 875-878.), initially downsampled (Zheng, G. X., Terry, J. M., Belgrader, P., Ryvkin, P., Bent, Z. W., Wilson, R., … & Bielas, J. H. (2017). Massively parallel digital transcriptional profiling single cells. Nature communications, 8(1), 14049.). Load scRNA-seq data corresponding labels. total 9 cell type labels, 100 cells cell type. , check performance two different HVG selection methods: Seurat v3 v.s. mixHVG. evaluation illustrated UMAP plots. First, show standard pipeline visualizing dataset default Seurat pipeline. Check Seurat tutorial details.  Second, can simply replace line FindVariableFeatures FindVariableFeaturesMix package mixhvg loaded apply mixHVG method.  evaluation adjusted rand index (ARI). Refer paper details. ARI UMAP HVG selection Seurat v3 0.6348 ARI UMAP HVG selection mixHVG 0.6767","code":"pbmc_hvg<-FindVariableFeaturesMix(pbmc,method.names=\"seuratv3\") pbmc_hvg<-FindVariableFeaturesMix(pbmc,method.names=\"scran\") pbmc_hvg<-FindVariableFeaturesMix(pbmc,           method.names=c(\"scran\",\"scran_pos\",\"seuratv1\")) expr<-readRDS(\"pbmc_900.rds\") cell_label<-read.table(\"cell_labels.txt\",header = T) cell_label<-factor(cell_label$cell_type_labels,levels = c(\"regulatory_t\",\"naive_t\",\"cd34\",\"memory_t\",\"cd56_nk\",\"cytotoxic_t\",\"cd14_monocytes\",\"b_cells\",\"naive_cytotoxic\")) library(Seurat)  npcs=30 set.seed(1) obj<-CreateSeuratObject(expr) obj$cell_label<-cell_label obj<-NormalizeData(obj,verbose=FALSE) obj<-FindVariableFeatures(obj,verbose=FALSE) obj<-ScaleData(obj,verbose=FALSE) suppressWarnings(obj<-RunPCA(obj,npcs=npcs,verbose=FALSE)) obj<-RunUMAP(obj,dims = 1:npcs,verbose=FALSE)  pdf(paste0(\"umap_hvg_by_seuratv3.pdf\"),height = 5.5,width = 7) DimPlot(obj,reduction = \"umap\",group.by = \"cell_label\",shuffle = T) dev.off() library(Seurat) library(mixhvg)  npcs=30 set.seed(1) pbmc<-CreateSeuratObject(expr) pbmc$cell_label<-cell_label pbmc<-NormalizeData(pbmc,verbose=FALSE) pbmc<-FindVariableFeaturesMix(pbmc,verbose=FALSE) pbmc<-ScaleData(pbmc,verbose=FALSE) suppressWarnings(pbmc<-RunPCA(pbmc,npcs=npcs,verbose=FALSE)) pbmc<-RunUMAP(pbmc,dims = 1:npcs,verbose=FALSE)  pdf(paste0(\"umap_hvg_by_mixhvg.pdf\"),height = 5.5,width = 7) DimPlot(pbmc,reduction = \"umap\",group.by = \"cell_label\",shuffle = T) dev.off() maxARI<-function(embedding,label){     label = as.numeric(as.factor(label))     snn_<- FindNeighbors(object = embedding,                          nn.method = \"rann\",                          verbose = F)$snn     res<-sapply( seq(0,2,0.1) ,function(cur){         cluster_label <- FindClusters(snn_,resolution = cur,                                       verbose = F)[[1]]         mclust::adjustedRandIndex(cluster_label,label)})     max(res) }  ari_seuratv3<-maxARI(obj@reductions$umap@cell.embeddings,cell_label) ari_mixhvg<-maxARI(pbmc@reductions$umap@cell.embeddings,cell_label)"},{"path":"/index.html","id":"method-choices","dir":"","previous_headings":"","what":"Method Choices","title":"Mixture of Multiple Highly Variable Feature Selection Methods","text":"following methods can chosen. also, mixture following methods acceptable. example, default c(“scran”,“seuratv1”,“mv_PFlogPF”,“scran_pos”) scran: Use mean-variance curve adjustment lognormalized count matrix, scran ModelGeneVar. mv_ct: Use mean-variance curve adjustment count matrix, inherited scran ModelGeneVar. mv_nc: Use mean-variance curve adjustment normalized count matrix, inherited scran ModelGeneVar. mv_lognc: scran. mv_PFlogPF: Use mean-variance curve adjustment PFlog1pPF matrix, inherited scran ModelGeneVar. scran_pos: Use scran poisson version, modelGeneVarByPoisson. seuratv3: Use logmean-logvariance curve adjustment count matrix, vst, Seurat FindVariableFeatures Function(https://satijalab.org/seurat/reference/findvariablefeatures). logmv_ct: seuratv3. logmv_nc: Use logmean-logvariance curve adjustment normalized count matrix, inherited seuratv3(vst). logmv_lognc: Use logmean-logvariance curve adjustment lognormalized count matrix, inherited seuratv3(vst). logmv_PFlogPF: Use logmean-logvariance curve adjustment PFlog1pPF matrix, inherited seuratv3(vst). seuratv1: Use dispersion lognormalized count matrix, dispersion (disp), Seurat FindVariableFeatures Function(https://satijalab.org/seurat/reference/findvariablefeatures). disp_lognc: seuratv1. disp_PFlogPF: Use dispersion PFlog1pPF matrix, inherited seuratv1(disp). mean_max_ct: Highly Expressed Features respect count matrix. mean_max_nc: Highly Expressed Features respect normalized count matrix. mean_max_lognc: Highly Expressed Features respect lognormalized count matrix","code":""},{"path":"/reference/FindVariableFeaturesMix.html","id":null,"dir":"Reference","previous_headings":"","what":"FindVariableFeaturesMix — FindVariableFeaturesMix","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"FindVariableFeaturesMix","code":""},{"path":"/reference/FindVariableFeaturesMix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"","code":"FindVariableFeaturesMix(   object,   method.names = c(\"scran\", \"scran_pos\", \"seuratv1\"),   nfeatures = 2000,   loess.span = 0.3,   clip.max = \"auto\",   num.bin = 20,   binning.method = \"equal_width\",   extra.rank = NULL,   verbose = FALSE )"},{"path":"/reference/FindVariableFeaturesMix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"object object, SeuratObject matrix(including sparse matrix) acceptable method.names following methods can directly used highly variable feature selection. mixture methods take vector method list, e.g. c(\"scran\",\"scran_pos\",\"seuratv1\"), also default. scran: Use mean-variance curve adjustment lognormalized count matrix, scran ModelGeneVar. mv_ct: Use mean-variance curve adjustment count matrix, inherited scran ModelGeneVar. mv_nc: Use mean-variance curve adjustment normalized count matrix, inherited scran ModelGeneVar. mv_lognc: scran. mv_PFlogPF: Use mean-variance curve adjustment PFlog1pPF matrix, inherited scran ModelGeneVar. scran_pos: Use scran poisson version, modelGeneVarByPoisson. seuratv3: Use logmean-logvariance curve adjustment count matrix, vst, Seurat FindVariableFeatures Function(https://satijalab.org/seurat/reference/findvariablefeatures). logmv_ct: seuratv3. logmv_nc: Use logmean-logvariance curve adjustment normalized count matrix, inherited seuratv3(vst). logmv_lognc: Use logmean-logvariance curve adjustment lognormalized count matrix, inherited seuratv3(vst). logmv_PFlogPF: Use logmean-logvariance curve adjustment PFlog1pPF matrix, inherited seuratv3(vst). seuratv1: Use dispersion lognormalized count matrix, dispersion (disp), Seurat FindVariableFeatures Function(https://satijalab.org/seurat/reference/findvariablefeatures). disp_lognc: seuratv1. disp_PFlogPF: Use dispersion PFlog1pPF matrix, inherited seuratv1(disp). mean_max_ct: Highly Expressed Features respect count matrix. mean_max_nc: Highly Expressed Features respect normalized count matrix. mean_max_lognc: Highly Expressed Features respect lognormalized count matrix nfeatures Number features select top variable features. loess.span (work logmv based methods like seuratv3). Loess span parameter used fitting variance-mean relationship clip.max (work logmv based methods like seuratv3). standardization values larger clip.max set clip.max; default 'auto' sets value square root number cells num.bin (work logmv dispersion based methods)Total number bins use scaled analysis (default 20) binning.method Specifies bins computed. Available methods : equal_width: bin equal width along x-axis[default]. equal_frequency: bin contains equal number features (can increase statistical power detect overdispersed features high expression values, cost reduced resolution along x-axis). extra.rank support user input customized gene rank. Provide best gene rank \"1\", worst gene largest number. verbose Whether show progress bar calculations. Default FALSE.","code":""},{"path":"/reference/FindVariableFeaturesMix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"object:  input SeuratObject, return also SeuratObject; input matrix(including sparse matrix), return highly variable feature names.","code":""},{"path":"/reference/FindVariableFeaturesMix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"function inherits FindVariableFeatures function Seurat Package. Refer https://github.com/RuzhangZhao/mixhvg user manual.","code":""},{"path":"/reference/FindVariableFeaturesMix.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"FindVariableFeaturesMix — FindVariableFeaturesMix","text":"","code":"if(0){ simple_matrix<-matrix(1:2e4,nrow=4000,ncol=5) rownames(simple_matrix)<-1:nrow(simple_matrix) colnames(simple_matrix)<-1:ncol(simple_matrix) simple_matrix_HVG<-FindVariableFeaturesMix(simple_matrix) }"}]
